<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Secure Note Courier â€” CMPS 380 Hybrid Crypto Demo (RSA)</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header class="topbar">
    <h1>ğŸ” Secure Note Courier <span class="sub">RSA-OAEP + AES-GCM + RSA-PSS</span></h1>
    <div class="actions">
      <button id="resetBtn" class="ghost" aria-label="Reset demo">Reset</button>
      <button id="themeBtn" class="ghost" title="Toggle dark mode" aria-label="Toggle dark mode">ğŸŒ™</button>
    </div>
  </header>

  <nav class="stepper" id="stepper" aria-label="Progress">
    <div class="step active"><span class="idx">1</span><span>Generate Keys</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">2</span><span>Exchange</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">3</span><span>Establish Shared Key</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">4</span><span>Encrypt</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">5</span><span>Sign</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">6</span><span>Send</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">7</span><span>Verify</span></div>
    <div class="sep"></div>
    <div class="step"><span class="idx">8</span><span>Decrypt</span></div>
  </nav>

  <main class="main">
    <div class="container">
      <section class="left">
        <div class="grid-two">
          <div class="card">
            <h3>Alice <span class="role badge pill">ğŸ–Š identity (RSA-PSS)</span> <span class="role badge pill subtle">ğŸ”‘ enc (RSA-OAEP)</span></h3>
            <div class="kv"><b>Enc pubkey (SPKI)</b><code class="copyable" id="aliceEnc">â€”</code></div>
            <div class="kv small"><b>Sig(enc pubkey)</b><code class="copyable" id="aliceEncSig">â€”</code></div>
          </div>

          <div class="card">
            <h3>Bob <span class="role badge pill">ğŸ–Š identity (RSA-PSS)</span> <span class="role badge pill subtle">ğŸ”‘ enc (RSA-OAEP)</span></h3>
            <div class="kv"><b>Enc pubkey (SPKI)</b><code class="copyable" id="bobEnc">â€”</code></div>
            <div class="kv small"><b>Sig(enc pubkey)</b><code class="copyable" id="bobEncSig">â€”</code></div>
          </div>
        </div>

        <div class="card">
          <h3>Note</h3>
          <textarea id="plaintext" rows="5" placeholder="Type a short note to Bob..." aria-label="Plaintext message"></textarea>
          <div class="presets">
            <button class="ghost small" data-preset="Meet at 3pm in lab 204.">Preset 1</button>
            <button class="ghost small" data-preset="Project key: BLUE-ALBATROSS">Preset 2</button>
            <button class="ghost small" data-preset="CMPS 380 rules! ğŸš€">Preset 3</button>
          </div>
        </div>
      </section>

      <section class="right">
        <div class="card callout">
          <div class="callout-head">
            <div>
              <div class="eyebrow" id="stepCount">Step 1 of 8</div>
              <h3 id="helpTitle">Generate Keys</h3>
            </div>
            <div class="time small" id="perf">â€”</div>
          </div>
          <ul id="helpBullets" class="bullets"></ul>
          <div id="helpTerms" class="terms"></div>
        </div>

        <div class="card">
          <h3>Artifacts</h3>
          <div class="kv"><b>AES key id (short hash)</b><code class="copyable" id="keyFp">â€”</code></div>
          <div class="kv"><b>Wrapped key (RSA-OAEP)</b><code class="copyable" id="wrappedKey">â€”</code></div>
          <div class="kv"><b>Nonce</b><code class="copyable" id="nonce">â€”</code></div>
          <div class="kv"><b>AAD</b><code class="copyable" id="aad">â€”</code></div>
          <div class="kv"><b>Ciphertext</b><code class="copyable" id="ciphertext">â€”</code></div>
          <div class="kv"><b>GCM tag</b><code class="copyable" id="tag">â€”</code></div>
          <div class="kv"><b>Envelope hash</b><code class="copyable" id="envHash">â€”</code></div>
          <div class="kv"><b>Signature</b><code class="copyable" id="signature">â€”</code></div>

          <div class="row">
            <label class="switch">
              <input type="checkbox" id="tamperCt">
              <span>Tamper ciphertext (flip 1 byte)</span>
            </label>
          </div>
          <div class="row">
            <label class="switch">
              <input type="checkbox" id="tamperSig">
              <span>Break signature (flip 1 byte)</span>
            </label>
          </div>

          <div class="row actions-inline">
            <a href="/api/download_envelope" class="ghost" id="dlBtn">Download envelope</a>
            <button class="ghost" id="copyEnvBtn" title="Copy envelope JSON to clipboard">Copy envelope</button>
          </div>
        </div>

        <div class="card">
          <h3>Status</h3>
          <div id="status" class="status ok" aria-live="polite">Ready</div>
        </div>
      </section>
    </div>

    <div class="controls">
      <button id="prevBtn" class="ghost" disabled>Back</button>
      <button id="nextBtn" class="primary">Next â†’</button>
    </div>
  </main>

  <footer class="foot small">CMPS 380 â€¢ RSA-OAEP key transport â€¢ AES-GCM â€¢ RSA-PSS</footer>

  <script src="/static/app.js"></script>
</body>
</html>
